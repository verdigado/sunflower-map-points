{"version":3,"file":"map/map-frontend.js","mappings":"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","sources":["webpack://sunflower-map-points/./src/map/map-frontend.js"],"sourcesContent":["/* global L */\n/* global MutationObserver */\n/* global sunflowerMapPoints */\n/* global bootstrap */\ndocument.addEventListener( 'DOMContentLoaded', () => {\n\tconst observer = new MutationObserver( () => {\n\t\tdocument.querySelectorAll( '.map-container' ).forEach( ( el ) => {\n\t\t\tif ( typeof L === 'undefined' ) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.error( 'Leaflet is not available' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst mapEl = el.querySelector( '#map' );\n\n\t\t\tif ( ! mapEl ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( mapEl && mapEl._leaflet_id ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst initLat = parseFloat( el.dataset.lat );\n\t\t\tconst initLng = parseFloat( el.dataset.lng );\n\t\t\tconst initZoom = parseInt( el.dataset.zoom, 10 );\n\n\t\t\tconst map = L.map( mapEl, {\n\t\t\t\tscrollWheelZoom: true,\n\t\t\t\tdragging: true,\n\t\t\t\tfullscreenControl: true,\n\t\t\t} ).setView( [ initLat, initLng ], initZoom );\n\n\t\t\tmapEl._leafletMap = map;\n\n\t\t\t// Custom \"Locate Me\" Control\n\t\t\tL.Control.LocateControl = L.Control.extend( {\n\t\t\t\tonAdd() {\n\t\t\t\t\tconst container = L.DomUtil.create(\n\t\t\t\t\t\t'div',\n\t\t\t\t\t\t'leaflet-bar leaflet-control leaflet-control-custom'\n\t\t\t\t\t);\n\n\t\t\t\t\tcontainer.innerHTML =\n\t\t\t\t\t\t'<i class=\"fa-solid fa-location-crosshairs\"></i>';\n\t\t\t\t\tcontainer.style.backgroundColor = 'white';\n\t\t\t\t\tcontainer.style.width = '34px';\n\t\t\t\t\tcontainer.style.height = '34px';\n\t\t\t\t\tcontainer.style.display = 'flex';\n\t\t\t\t\tcontainer.style.alignItems = 'center';\n\t\t\t\t\tcontainer.style.justifyContent = 'center';\n\t\t\t\t\tcontainer.style.cursor = 'pointer';\n\n\t\t\t\t\tcontainer.onclick = function () {\n\t\t\t\t\t\tmap.locate( { setView: true, maxZoom: 15 } );\n\t\t\t\t\t};\n\n\t\t\t\t\t// Mausinteraktion auf der Karte nicht blockieren\n\t\t\t\t\tL.DomEvent.disableClickPropagation( container );\n\n\t\t\t\t\treturn container;\n\t\t\t\t},\n\t\t\t} );\n\n\t\t\tL.tileLayer( 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n\t\t\t\tmaxZoom: 19,\n\t\t\t\tattribution:\n\t\t\t\t\t'&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap contributors</a>',\n\t\t\t} ).addTo( map );\n\n\t\t\tmap.addControl(\n\t\t\t\tnew L.Control.LocateControl( { position: 'topright' } )\n\t\t\t);\n\n\t\t\tmap.on( 'locationfound', function ( e ) {\n\t\t\t\tconst marker = L.marker( e.latlng )\n\t\t\t\t\t.addTo( map )\n\t\t\t\t\t.bindPopup( 'Du bist hier!' )\n\t\t\t\t\t.openPopup();\n\n\t\t\t\tL.circle( e.latlng, {\n\t\t\t\t\tradius: e.accuracy,\n\t\t\t\t\tcolor: '#136aec',\n\t\t\t\t\tfillColor: '#136aec',\n\t\t\t\t\tfillOpacity: 0.2,\n\t\t\t\t} ).addTo( map );\n\n\t\t\t\t// Remove marker of current location after 2 seconds\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tmap.removeLayer( marker );\n\t\t\t\t}, 2000 );\n\t\t\t} );\n\n\t\t\tmap.on( 'locationerror', function ( e ) {\n\t\t\t\t// eslint-disable-next-line no-alert, no-undef\n\t\t\t\talert( 'Standort konnte nicht gefunden werden: ' + e.message );\n\t\t\t} );\n\n\t\t\tlet lastLat = null;\n\t\t\tlet lastLng = null;\n\n\t\t\tmap.on( 'click', function ( e ) {\n\t\t\t\tlastLat = e.latlng.lat.toFixed( 6 );\n\t\t\t\tlastLng = e.latlng.lng.toFixed( 6 );\n\n\t\t\t\t// Marker-Icon\n\t\t\t\tconst customIcon = L.icon( {\n\t\t\t\t\ticonUrl: sunflowerMapPoints.maps_marker,\n\t\t\t\t\ticonSize: [ 25, 41 ],\n\t\t\t\t\ticonAnchor: [ 12, 41 ],\n\t\t\t\t\tpopupAnchor: [ 0, -25 ],\n\t\t\t\t} );\n\n\t\t\t\t// Alten Marker entfernen\n\t\t\t\tif ( map._marker ) {\n\t\t\t\t\tmap.removeLayer( map._marker );\n\t\t\t\t}\n\n\t\t\t\t// Neuen Marker setzen\n\t\t\t\tmap._marker = L.marker( [ lastLat, lastLng ], {\n\t\t\t\t\ticon: customIcon,\n\t\t\t\t} ).addTo( map );\n\n\t\t\t\t// Formular-Werte setzen\n\t\t\t\tdocument.querySelector( '#form-lat' ).value = lastLat;\n\t\t\t\tdocument.querySelector( '#form-lng' ).value = lastLng;\n\n\t\t\t\t// Modal anzeigen\n\t\t\t\tif (\n\t\t\t\t\ttypeof bootstrap !== 'undefined' &&\n\t\t\t\t\ttypeof bootstrap.Modal === 'function'\n\t\t\t\t) {\n\t\t\t\t\tconst modal = new bootstrap.Modal(\n\t\t\t\t\t\tdocument.getElementById( 'leafletModal' )\n\t\t\t\t\t);\n\t\t\t\t\tmodal.show();\n\t\t\t\t} else {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.log( 'Bootstrap is not available' );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\n\t\tconst modalEl = document.getElementById( 'leafletModal' );\n\t\tif ( modalEl ) {\n\t\t\tmodalEl.addEventListener( 'shown.bs.modal', () => {\n\t\t\t\tconst form = document.getElementById( 'leaflet-form' );\n\n\t\t\t\tif ( ! form || form.dataset.handlerAttached === 'true' ) {\n\t\t\t\t\treturn; // Handler schon gesetzt oder kein Formular vorhanden\n\t\t\t\t}\n\n\t\t\t\t// Mini map on top of modal form\n\t\t\t\tconst miniMapEl = document.getElementById( 'mini-map' );\n\t\t\t\tif ( miniMapEl ) {\n\t\t\t\t\tconst lat = parseFloat(\n\t\t\t\t\t\tdocument.querySelector( '#form-lat' ).value\n\t\t\t\t\t);\n\t\t\t\t\tconst lng = parseFloat(\n\t\t\t\t\t\tdocument.querySelector( '#form-lng' ).value\n\t\t\t\t\t);\n\n\t\t\t\t\tif ( ! window.miniMap ) {\n\t\t\t\t\t\twindow.miniMap = L.map( miniMapEl, {\n\t\t\t\t\t\t\tcenter: [ lat, lng ],\n\t\t\t\t\t\t\tzoom: 17,\n\t\t\t\t\t\t\tdragging: false,\n\t\t\t\t\t\t\tscrollWheelZoom: false,\n\t\t\t\t\t\t\tzoomControl: false,\n\t\t\t\t\t\t\tattributionControl: false,\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tL.tileLayer(\n\t\t\t\t\t\t\t'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmaxZoom: 19,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t).addTo( window.miniMap );\n\n\t\t\t\t\t\tconst customIcon = L.icon( {\n\t\t\t\t\t\t\ticonUrl: sunflowerMapPoints.maps_marker,\n\t\t\t\t\t\t\ticonSize: [ 25, 41 ],\n\t\t\t\t\t\t\ticonAnchor: [ 12, 41 ],\n\t\t\t\t\t\t\tpopupAnchor: [ 0, -25 ],\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\twindow.miniMarker = L.marker( [ lat, lng ], {\n\t\t\t\t\t\t\ticon: customIcon,\n\t\t\t\t\t\t} ).addTo( window.miniMap );\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.miniMap.setView( [ lat, lng ] );\n\t\t\t\t\t\tif ( window.miniMarker ) {\n\t\t\t\t\t\t\twindow.miniMap.removeLayer( window.miniMarker );\n\t\t\t\t\t\t}\n\t\t\t\t\t\twindow.miniMarker = L.marker( [ lat, lng ] ).addTo(\n\t\t\t\t\t\t\twindow.miniMap\n\t\t\t\t\t\t);\n\t\t\t\t\t\twindow.miniMap.invalidateSize();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst mapEl = document.querySelector( '#map' );\n\t\t\t\tconst map = mapEl?._leafletMap;\n\n\t\t\t\tform.addEventListener( 'submit', function ( e ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst formData = new FormData( form );\n\t\t\t\t\tconst messageBox =\n\t\t\t\t\t\tdocument.getElementById( 'form-message' );\n\n\t\t\t\t\t// Reset message box\n\t\t\t\t\tmessageBox.classList.add( 'd-none', 'alert' );\n\t\t\t\t\tmessageBox.classList.remove(\n\t\t\t\t\t\t'alert-success',\n\t\t\t\t\t\t'alert-danger'\n\t\t\t\t\t);\n\t\t\t\t\tmessageBox.textContent = '';\n\n\t\t\t\t\tfetch( sunflowerMapPoints.ajaxurl, {\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tcredentials: 'same-origin',\n\t\t\t\t\t\tbody: formData,\n\t\t\t\t\t} )\n\t\t\t\t\t\t.then( ( response ) => response.json() )\n\t\t\t\t\t\t.then( ( data ) => {\n\t\t\t\t\t\t\tif ( data.success ) {\n\t\t\t\t\t\t\t\tform.classList.add( 'd-none' );\n\t\t\t\t\t\t\t\tform.reset();\n\t\t\t\t\t\t\t\tmessageBox.innerHTML = data?.messageafter;\n\t\t\t\t\t\t\t\tmessageBox.classList.remove( 'd-none' );\n\t\t\t\t\t\t\t\tmessageBox.classList.add(\n\t\t\t\t\t\t\t\t\t'alert',\n\t\t\t\t\t\t\t\t\t'alert-success'\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\t\t\t\tif ( modalEl ) {\n\t\t\t\t\t\t\t\t\t\tconst modal =\n\t\t\t\t\t\t\t\t\t\t\tbootstrap.Modal.getInstance(\n\t\t\t\t\t\t\t\t\t\t\t\tmodalEl\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tmodal?.hide();\n\t\t\t\t\t\t\t\t\t\tmessageBox.classList.add( 'd-none' );\n\t\t\t\t\t\t\t\t\t\tmessageBox.textContent = '';\n\t\t\t\t\t\t\t\t\t\tform.classList.remove( 'd-none' );\n\n\t\t\t\t\t\t\t\t\t\t// remove marker\n\t\t\t\t\t\t\t\t\t\tif ( map?._marker ) {\n\t\t\t\t\t\t\t\t\t\t\tmap.removeLayer( map._marker );\n\t\t\t\t\t\t\t\t\t\t\tmap._marker = null;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}, 5000 );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmessageBox.textContent =\n\t\t\t\t\t\t\t\t\tdata?.messageafter ||\n\t\t\t\t\t\t\t\t\t'Ein Fehler ist aufgetreten.';\n\t\t\t\t\t\t\t\tmessageBox.classList.remove( 'd-none' );\n\t\t\t\t\t\t\t\tmessageBox.classList.add(\n\t\t\t\t\t\t\t\t\t'alert',\n\t\t\t\t\t\t\t\t\t'alert-danger'\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} )\n\t\t\t\t\t\t.catch( () => {\n\t\t\t\t\t\t\tmessageBox.textContent =\n\t\t\t\t\t\t\t\t'Fehler bei der Ãœbertragung.';\n\t\t\t\t\t\t\tmessageBox.classList.remove( 'd-none' );\n\t\t\t\t\t\t\tmessageBox.classList.add( 'alert', 'alert-danger' );\n\t\t\t\t\t\t} );\n\t\t\t\t} );\n\n\t\t\t\t// Markiere, dass der Handler schon gesetzt wurde\n\t\t\t\tform.dataset.handlerAttached = 'true';\n\t\t\t} );\n\n\t\t\tmodalEl.addEventListener( 'hidden.bs.modal', () => {\n\t\t\t\tconst form = document.getElementById( 'leaflet-form' );\n\t\t\t\tform.dataset.handlerAttached = 'false';\n\t\t\t\tform.reset();\n\n\t\t\t\tif ( window.miniMap ) {\n\t\t\t\t\twindow.miniMap.remove();\n\t\t\t\t\twindow.miniMap = null;\n\t\t\t\t\twindow.miniMarker = null;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n\n\tobserver.observe( document.body, { childList: true, subtree: true } );\n} );\n"],"names":["document","addEventListener","observer","MutationObserver","querySelectorAll","forEach","el","L","console","error","mapEl","querySelector","_leaflet_id","initLat","parseFloat","dataset","lat","initLng","lng","initZoom","parseInt","zoom","map","scrollWheelZoom","dragging","fullscreenControl","setView","_leafletMap","Control","LocateControl","extend","onAdd","container","DomUtil","create","innerHTML","style","backgroundColor","width","height","display","alignItems","justifyContent","cursor","onclick","locate","maxZoom","DomEvent","disableClickPropagation","tileLayer","attribution","addTo","addControl","position","on","e","marker","latlng","bindPopup","openPopup","circle","radius","accuracy","color","fillColor","fillOpacity","setTimeout","removeLayer","alert","message","lastLat","lastLng","toFixed","customIcon","icon","iconUrl","sunflowerMapPoints","maps_marker","iconSize","iconAnchor","popupAnchor","_marker","value","bootstrap","Modal","modal","getElementById","show","log","modalEl","form","handlerAttached","miniMapEl","window","miniMap","center","zoomControl","attributionControl","miniMarker","invalidateSize","preventDefault","formData","FormData","messageBox","classList","add","remove","textContent","fetch","ajaxurl","method","credentials","body","then","response","json","data","success","reset","messageafter","getInstance","hide","catch","observe","childList","subtree"],"sourceRoot":""}